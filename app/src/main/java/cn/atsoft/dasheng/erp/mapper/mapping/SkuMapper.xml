<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.atsoft.dasheng.erp.mapper.SkuMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="cn.atsoft.dasheng.erp.entity.Sku">
        <id column="sku_id" property="skuId"/>
        <result column="sku_name" property="skuName"/>
        <result column="sku_value" property="skuValue"/>
        <result column="is_ban" property="isBan"/>
        <result column="sku_value_md5" property="skuValueMd5"/>
        <result column="spu_id" property="spuId"/>
        <result column="standard" property="standard"/>
        <result column="specifications" property="specifications"/>
        <result column="create_time" property="createTime"/>
        <result column="create_user" property="createUser"/>
        <result column="update_time" property="updateTime"/>
        <result column="update_user" property="updateUser"/>
        <result column="display" property="display"/>
        <result column="remarks" property="remarks"/>
        <result column="type" property="type"/>
        <result column="coding" property="coding"/>
        <result column="batch" property="batch"/>
        <result column="quality_plan_id" property="qualityPlanId"/>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">type
    AS "type",coding AS "coding",quality_plan_id AS "qualityPlanId",
        sku_id
        AS "skuId",batch AS "batch", sku_name AS "skuName",remarks AS "remarks",standard AS standard,specifications AS "specifications",is_ban AS "isBan",sku_value_md5 AS "skuValueMd5", spu_id AS "spuId", sku_value AS "skuValue",create_time AS "createTime", create_user AS "createUser", update_time AS "updateTime", update_user AS "updateUser", display AS "display"
    </sql>


    <select id="customList" resultType="cn.atsoft.dasheng.erp.model.result.SkuResult"
            parameterType="cn.atsoft.dasheng.erp.model.params.SkuParam">
        select
        <include refid="Base_Column_List"/>
        from goods_sku where 1 = 1 and display = 1
        <if test="paramCondition.skuId != null">
            and sku_id like CONCAT('%',#{paramCondition.skuId},'%')
        </if>
        <if test="paramCondition.skuName != null and paramCondition.skuName != ''">
            and sku_name like CONCAT('%',#{paramCondition.skuName},'%')
        </if>
        <if test="paramCondition.spuId != null">
            and spu_id like CONCAT('%',#{paramCondition.spuId},'%')
        </if>
    </select>

    <select id="customMapList" resultType="map" parameterType="cn.atsoft.dasheng.erp.model.params.SkuParam">
        select
        <include refid="Base_Column_List"/>
        from goods_sku where 1 = 1 and display = 1
        <if test="paramCondition.skuId != null">
            and sku_id like CONCAT('%',#{paramCondition.skuId},'%')
        </if>
        <if test="paramCondition.skuName != null and paramCondition.skuName != ''">
            and sku_name like CONCAT('%',#{paramCondition.skuName},'%')
        </if>
        <if test="paramCondition.spuId != null">
            and spu_id like CONCAT('%',#{paramCondition.spuId},'%')
        </if>
    </select>

    <select id="customPageList" resultType="cn.atsoft.dasheng.erp.model.result.SkuResult"
            parameterType="cn.atsoft.dasheng.erp.model.params.SkuParam">
        select
        <include refid="Base_Column_List"/>
        from goods_sku where 1 = 1 and display =1
        <if test="paramCondition.skuId != null">

            and sku_id like CONCAT('%',#{paramCondition.skuId},'%')
        </if>
        <if test="paramCondition.coding != null">
            and coding like CONCAT('%',#{paramCondition.coding},'%')
        </if>
        <if test="paramCondition.skuName != null and paramCondition.skuName != ''">
            and spu_id IN(SELECT spu_id from goods_spu where name like CONCAT ('%',#{paramCondition.skuName},'%') )
            UNION
            select
            <include refid="Base_Column_List"/>
            from goods_sku where sku_name like CONCAT('%',#{paramCondition.skuName},'%')
        </if>
        <if test="paramCondition.type != null">
            and type = #{paramCondition.type}
        </if>
        <if test="paramCondition.standard != null">
            and standard like CONCAT('%',#{paramCondition.standard},'%')
        </if>
        <if test="paramCondition.spuId != null">
            and spu_id like CONCAT('%',#{paramCondition.spuId},'%')
        </if>

        <if test="spuIds != null  and spuIds.size > 0 ">
            and spu_id in
            <foreach collection="spuIds" index="index" item="state" separator="," close=")" open="(">
                #{state}
            </foreach>

        </if>
        <if test="paramCondition.skuIds != null  and paramCondition.skuIds.size > 0 ">
            and sku_id in
            <foreach collection="paramCondition.skuIds" index="index" item="state" separator="," close=")" open="(">
                #{state}
            </foreach>

        </if>

    </select>

    <select id="customPageMapList" resultType="map" parameterType="cn.atsoft.dasheng.erp.model.params.SkuParam">
        select
        <include refid="Base_Column_List"/>
        from goods_sku where 1 = 1 and display = 1
        <if test="paramCondition.skuId != null">
            and sku_id like CONCAT('%',#{paramCondition.skuId},'%')
        </if>
        <if test="paramCondition.skuName != null and paramCondition.skuName != ''">
            and sku_name like CONCAT('%',#{paramCondition.skuName},'%')
        </if>
        <if test="paramCondition.spuId != null">
            and spu_id like CONCAT('%',#{paramCondition.spuId},'%')
        </if>
    </select>

</mapper>
